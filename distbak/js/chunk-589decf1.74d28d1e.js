(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-589decf1"],{"25f0":function(e,t,r){"use strict";var a=r("e330"),n=r("5e77").PROPER,l=r("6eeb"),o=r("825a"),i=r("3a9b"),s=r("577e"),c=r("d039"),u=r("ad6d"),d="toString",f=RegExp.prototype,m=f[d],p=a(u),b=c((function(){return"/a/b"!=m.call({source:"a",flags:"b"})})),h=n&&m.name!=d;(b||h)&&l(RegExp.prototype,d,(function(){var e=o(this),t=s(e.source),r=e.flags,a=s(void 0===r&&i(f,e)&&!("flags"in f)?p(e):r);return"/"+t+"/"+a}),{unsafe:!0})},"4de4":function(e,t,r){"use strict";var a=r("23e7"),n=r("b727").filter,l=r("1dde"),o=l("filter");a({target:"Array",proto:!0,forced:!o},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},"7d432":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"search"},[r("Search",{on:{onSubmit:function(t){return e.click(t)}}})],1),r("div",[r("ServerList",{ref:"ServerList"})],1)])},n=[],l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{attrs:{inline:!0,model:e.formInline}},[r("el-form-item",{attrs:{label:"IP:"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入IP"},model:{value:e.formInline.ip,callback:function(t){e.$set(e.formInline,"ip",t)},expression:"formInline.ip"}})],1),e.roleadmin?r("el-form-item",{attrs:{label:"虚机名称"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入虚机名称支持模糊"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1):e._e(),r("el-form-item",{attrs:{label:"主机名:"}},[r("el-input",{attrs:{clearable:"",placeholder:"主机名"},model:{value:e.formInline.host,callback:function(t){e.$set(e.formInline,"host",t)},expression:"formInline.host"}})],1),e.roleadmin?r("el-form-item",{attrs:{label:"集群:"}},[r("el-select",{attrs:{clearable:"",placeholder:"集群名称"},on:{change:e.regionChange},model:{value:e.formInline.cluster,callback:function(t){e.$set(e.formInline,"cluster",t)},expression:"formInline.cluster"}},e._l(e.datas.clusters,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1):e._e(),e.roleadmin?r("el-form-item",{attrs:{label:"项目:"}},[r("el-select",{attrs:{clearable:"",placeholder:"项目名称"},model:{value:e.formInline.project,callback:function(t){e.$set(e.formInline,"project",t)},expression:"formInline.project"}},e._l(e.projects,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1):e._e(),e.roleadmin?r("el-form-item",{attrs:{label:"查询日期"}},[r("el-date-picker",{staticStyle:{width:"150px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.formInline.date,callback:function(t){e.$set(e.formInline,"date",t)},expression:"formInline.date"}})],1):e._e(),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e.roleadmin?r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.Sync}},[e._v("同步数据源")]):e._e()],1)],1)},o=[],i=r("1da1"),s=(r("96cf"),r("4de4"),r("d3b7"),r("b4bd")),c={data:function(){return{formInline:{ip:"",date:"",name:"",cluster:"",host:"",project:""},projects:{},datas:{},loading:!1,roleadmin:!1}},created:function(){var e=this,t=this.$store.getters.role;t.filter((function(e){return"admin"==e})).length>0&&(this.roleadmin=!0),new Promise((function(t,r){s["a"].getChannels().then((function(r){e.datas=r.data.data,t()})).catch((function(e){r(e)}))}))},methods:{onSubmit:function(){this.$emit("onSubmit",this.formInline)},regionChange:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.projects=t.datas.projects.filter((function(t){return t.cluster_name===e}))[0].projects_map;case 1:case"end":return r.stop()}}),r)})))()},Sync:function(){var e=this;this.loading=!0,s["a"].Syncdata(),setTimeout((function(){e.loading=!1}),1e5)}}},u=c,d=r("2877"),f=Object(d["a"])(u,l,o,!1,null,null,null),m=f.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{style:{display:e.download}},[r("download-excel",{attrs:{data:e.tableData,fields:e.json_fields,type:"csv",worksheet:"servers",name:"servers.xls"}},[r("el-button",{attrs:{type:"success"}},[e._v(" 导出excel")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[r("el-table-column",{attrs:{fixed:"",prop:"name",label:"名称"}}),r("el-table-column",{attrs:{fixed:"",prop:"uuid",label:"uuid"}}),r("el-table-column",{attrs:{fixed:"",prop:"project",label:"项目"}}),r("el-table-column",{attrs:{fixed:"",prop:"status",label:"状态"}}),r("el-table-column",{attrs:{fixed:"",prop:"ip",label:"IP"}}),r("el-table-column",{attrs:{fixed:"",prop:"flavor",label:"配置"}}),r("el-table-column",{attrs:{fixed:"",prop:"disk",label:"硬盘(G)"}}),r("el-table-column",{attrs:{fixed:"",prop:"host",label:"宿主机"}}),r("el-table-column",{attrs:{fixed:"",prop:"created",label:"创建时间"}}),r("el-table-column",{attrs:{fixed:"",prop:"cluster",label:"可用区"}}),e.roleadmin?r("el-table-column",{attrs:{fixed:"right",label:"控制台",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.CreateVNCConsole(t.row)}}},[e._v("进入控制台")])]}}],null,!1,3934009450)}):e._e()],1)],1)},b=[],h=r("b85c"),v=(r("b0c0"),r("25f0"),{data:function(){return{json_fields:{"名称":"name",uuid:"uuid","项目":"project","状态":"status",IP:"ip","配置":"flavor","硬盘(G)":"disk","宿主机":"host","创建时间":"created","可用区":"cluster"},tableData:[],download:"none",roleadmin:!1}},created:function(){var e=this.$store.getters.role;e.filter((function(e){return"admin"==e})).length>0&&(this.roleadmin=!0)},methods:{getDataMethod:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a={ip:e.ip,date:e.date,cluster:e.cluster,host:e.host,project:e.project,name:e.name},new Promise((function(e,r){s["a"].getData(a).then((function(r){t.tableData=[],console.log(r.data.data.servers);var a,n=Object(h["a"])(r.data.data.servers);try{for(n.s();!(a=n.n()).done;){var l=a.value;t.tableData.push({created:l.created,uuid:l.uuid,name:l.name,ip:l.ip.toString(),cluster:l.cluster_name,flavor:l.flavor.name,disk:l.volumes_size,status:l.status,host:l.node,project:l.project})}}catch(o){n.e(o)}finally{n.f()}t.download="block",e()})).catch((function(e){r(e)}))}));case 2:case"end":return r.stop()}}),r)})))()},CreateVNCConsole:function(e){var t={uuid:e.uuid,cluster:e.cluster};new Promise((function(e,r){s["a"].createVNCConsole(t).then((function(t){console.log(t),window.open(t.data.data.url,"_blank"),e()})).catch((function(e){r(e)}))}))}}}),g=v,y=Object(d["a"])(g,p,b,!1,null,null,null),j=y.exports,x={components:{Search:m,ServerList:j},methods:{click:function(e){this.$refs.ServerList.getDataMethod(e)}}},k=x,w=Object(d["a"])(k,a,n,!1,null,null,null);t["default"]=w.exports},b4bd:function(e,t,r){"use strict";var a=r("b775"),n=r("4328"),l=r.n(n);t["a"]={getChannels:function(){return Object(a["a"])({url:"/api/v1/servers/ServerList",method:"get"})},getData:function(e){var t="/api/v1/servers/ServerList",r=l.a.stringify(e),n=t+"?"+r;return Object(a["a"])({url:n,method:"get"})},createBill:function(e){var t="/api/v1/servers/CreateBill",r=l.a.stringify(e),n=t+"?"+r;return Object(a["a"])({url:n,method:"get"})},getBill:function(e){var t="/api/v1/servers/GetBill",r=l.a.stringify(e),n=t+"?"+r;return Object(a["a"])({url:n,method:"get"})},Syncdata:function(){var e="/api/v1/servers/SyncData";return Object(a["a"])({url:e,method:"get"})},createVNCConsole:function(e){var t="/api/v1/servers/CreateVNCConsole";return Object(a["a"])({url:t,method:"post",params:e})}}}}]);
//# sourceMappingURL=chunk-589decf1.74d28d1e.js.map