(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07e815d8"],{"1d809":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search"},[a("Search",{on:{onSubmit:function(t){return e.click(t)}}})],1),a("div",[a("bill",{ref:"bill"})],1)])},r=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"集群:"}},[a("el-select",{attrs:{clearable:"",placeholder:"集群名称"},model:{value:e.formInline.cluster,callback:function(t){e.$set(e.formInline,"cluster",t)},expression:"formInline.cluster"}},e._l(e.datas.clusters,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"查询日期"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.formInline.date,callback:function(t){e.$set(e.formInline,"date",t)},expression:"formInline.date"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("账单明细")]),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.createBill}},[e._v("生产账单")])],1)],1)},o=[],i=(a("d3b7"),a("b4bd")),c={data:function(){return{formInline:{cluster:"",date:""},datas:{},loading:!1}},created:function(){var e=this;new Promise((function(t,a){i["a"].getChannels().then((function(a){e.datas=a.data.data,t()})).catch((function(e){a(e)}))}))},methods:{onSubmit:function(){this.$emit("onSubmit",this.formInline)},createBill:function(){var e=this;this.loading=!0,i["a"].createBill(this.formInline),setTimeout((function(){e.loading=!1}),1e4)},checkoutExcel:function(){console.log("abc")}}},s=c,u=a("2877"),d=Object(u["a"])(s,n,o,!1,null,null,null),f=d.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{style:{display:e.download}},[a("download-excel",{attrs:{data:e.tableData,fields:e.json_fields,type:"csv",worksheet:"账单",name:"账单.xls"}},[a("el-button",{attrs:{type:"success"}},[e._v(" 到出excel")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"date",label:"日期"}}),a("el-table-column",{attrs:{fixed:"",prop:"cluster",label:"集群"}}),a("el-table-column",{attrs:{fixed:"",prop:"project",label:"项目"}}),a("el-table-column",{attrs:{fixed:"",prop:"servers",label:"云主机台数(台)"}}),a("el-table-column",{attrs:{fixed:"",prop:"vcpu",label:"cpu数量(核)"}}),a("el-table-column",{attrs:{fixed:"",prop:"ram",label:"内存数量(G)"}}),a("el-table-column",{attrs:{fixed:"",prop:"disk",label:"硬盘数量(G)"}})],1)],1)},b=[],p=a("b85c"),v=a("1da1"),h=(a("96cf"),{data:function(){return{json_fields:{"日期":"date","集群":"cluster","项目":"project","云主机台数(台)":"servers","cpu数量(核)":"vcpu","内存数量(G)":"ram","硬盘数量(G)":"disk"},tableData:[],download:"none"}},methods:{getBillMethod:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:l={cluster:e.cluster,date:e.date},new Promise((function(e,a){i["a"].getBill(l).then((function(a){t.tableData=[],console.log(a.data.data);var l,r=Object(p["a"])(a.data.data);try{for(r.s();!(l=r.n()).done;){var n,o=l.value,i=o.date,c=o.cluster,s=Object(p["a"])(o.aggdata);try{for(s.s();!(n=s.n()).done;){var u=n.value;t.tableData.push({date:i,cluster:c,project:u._id.project,servers:u.servers,vcpu:u.vcpus,ram:u.ram/1024,disk:u.disk})}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}t.download="block",e()})).catch((function(e){a(e)}))}));case 2:case"end":return a.stop()}}),a)})))()}}}),g=h,y=(a("5573"),Object(u["a"])(g,m,b,!1,null,null,null)),j=y.exports,k=a("5f87"),w={components:{Search:f,bill:j},created:function(){void 0!==Object(k["b"])()&&"admin"===Object(k["a"])()||(this.$router.push({path:"/login"}).catch((function(e){return console.log(e)})),Message({message:"请提供足够权限的用户",type:"error",duration:500}))},methods:{click:function(e){this.$refs.bill.getBillMethod(e)}}},x=w,O=Object(u["a"])(x,l,r,!1,null,null,null);t["default"]=O.exports},5573:function(e,t,a){"use strict";a("f844")},b4bd:function(e,t,a){"use strict";var l=a("b775"),r=a("4328"),n=a.n(r);t["a"]={getChannels:function(){return Object(l["a"])({url:"/api/v1/servers/ServerList",method:"get"})},getData:function(e){var t="/api/v1/servers/ServerList",a=n.a.stringify(e),r=t+"?"+a;return Object(l["a"])({url:r,method:"get"})},createBill:function(e){var t="/api/v1/servers/CreateBill",a=n.a.stringify(e),r=t+"?"+a;return Object(l["a"])({url:r,method:"get"})},getBill:function(e){var t="/api/v1/servers/GetBill",a=n.a.stringify(e),r=t+"?"+a;return Object(l["a"])({url:r,method:"get"})},Syncdata:function(){var e="/api/v1/servers/SyncData";return Object(l["a"])({url:e,method:"get"})},createVNCConsole:function(e){var t="/api/v1/servers/CreateVNCConsole";return Object(l["a"])({url:t,method:"post",params:e})}}},f844:function(e,t,a){}}]);
//# sourceMappingURL=chunk-07e815d8.f3bdb83d.js.map